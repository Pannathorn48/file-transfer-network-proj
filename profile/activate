_OLD_PATH="$PATH"
NETWORK_ACTIVATE=true

server(){
    make server
    echo "------------------------"
    ./bin/server "$@"
}

client(){
    make client
    echo "------------------------"
    ./bin/client "$@"
}

deactivate() {
       if [ "$NETWORK_ACTIVATE" = "true" ]; then
           export PATH="$_OLD_PATH"
           export PS1="$_OLD_PS1"
           unset NETWORK_ACTIVATE
           unset _OLD_PATH
           echo "Deactivated network environment."
       else
           echo "No network environment is active."
       fi
}

# Parse command line arguments
case "$1" in
    "server")
        shift
        server "$@"
        ;;
    "client")
        shift
        client "$@"
        ;;
    "deactivate")
        deactivate
        ;;
    "help"|"-h"|"--help")
        echo "Usage: $0 {server|client|deactivate|help}"
        echo "  server    - Build and run the server with optional arguments"
        echo "  client    - Build and run the client with optional arguments"
        echo "  deactivate - Deactivate the network environment"
        echo "  help      - Show this help message"
        ;;
    "")
        # If no arguments, just source the file (current behavior)
        ;;
    *)
        echo "Unknown command: $1"
        echo "Use '$0 help' for usage information"
        exit 1
        ;;
esac
